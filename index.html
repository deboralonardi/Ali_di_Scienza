<!DOCTYPE html>
<html lang="it" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PCTO AeroPhysics ‚Äì Sito Vetrina Editabile</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { box-sizing: border-box; }
    .space-bg { background: linear-gradient(135deg, #0c0c0c 0%, #1a1a2e 50%, #16213e 100%); }
    .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .neon-glow { box-shadow: 0 0 20px rgba(102,126,234,.5); }
    .hover-lift { transition: transform .3s ease, box-shadow .3s ease; }
    .hover-lift:hover { transform: translateY(-5px); box-shadow: 0 20px 40px rgba(0,0,0,.2); }
    .page { display: none; }
    .page.active { display: block; }
    .nav-link { transition: all .3s ease; position: relative; }
    .nav-link.active { color: #60a5fa; }
    .nav-link.active::after { content: ""; position: absolute; bottom: -2px; left: 0; right: 0; height: 2px; background: linear-gradient(90deg,#60a5fa,#a78bfa); }
    .floating-animation { animation: float 6s ease-in-out infinite; }
    @keyframes float { 0%,100%{transform: translateY(0)} 50%{transform: translateY(-20px)} }
    .pulse-animation { animation: pulse 2s infinite; }
    @keyframes pulse { 0%,100%{opacity:1} 50%{opacity:.7} }
    .mobile-menu { display: none; }
    .mobile-menu.open { display: block; }
    @media (max-width:768px){ .desktop-menu{display:none} .mobile-menu-btn{display:block} }
    @media (min-width:769px){ .mobile-menu-btn{display:none} }
    .file-upload-area{ border:2px dashed #60a5fa; transition: all .3s ease; }
    .file-upload-area:hover{ border-color:#a78bfa; background-color: rgba(96,165,250,.1); }

    /* Modifica in-place: solo gli elementi con questa classe diventano editabili */
    .editing-enabled { position: relative; cursor: text; }
    .editing-enabled:hover { background-color: rgba(59,130,246,.08); border-radius: 4px; outline: 1px dashed rgba(59,130,246,.5); }
    .editing-enabled[contenteditable="true"] { background-color: rgba(59,130,246,.12); outline: 2px solid #3b82f6; border-radius: 4px; }
    .editing-enabled[contenteditable="true"]:focus { outline: 2px solid #10b981; background-color: rgba(16,185,129,.10); }

    /* Banner edit */
    .edit-banner { position: fixed; top: 1rem; left: 1rem; z-index: 50; }

    /* Controls visible only in editing mode */
    .editing-controls { display: none; }
    .editing-controls.visible { display: block; }
    .material-link-input { background-color: rgba(255,255,255,0.04); border: 1px dashed rgba(255,255,255,0.08); color: #fff; padding: .4rem .6rem; border-radius: .5rem; width:100%; }
    .material-controls { margin-top: .6rem; display:flex; gap:.5rem; align-items:center; }
    .material-controls .btn { padding:.4rem .6rem; border-radius:.4rem; font-size:.875rem; }
    .material-hint { font-size:.75rem; color:#9ca3af; }
    .material-download { display:inline-block; text-decoration:none; }
    .hidden { display: none !important; }
  </style>
</head>
<body class="h-full space-bg text-white">
  <!-- Banner modalit√† -->
  <div id="editBanner" class="edit-banner bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg text-sm hidden">
    <div class="flex items-center space-x-2">
      <span>‚úèÔ∏è</span>
      <span>Modalit√† Editing Attiva ‚Äì clicca sui testi per modificarli</span>
    </div>
  </div>

  <!-- Header -->
  <header class="bg-black/50 backdrop-blur-md sticky top-0 z-40 border-b border-blue-500/30">
    <div class="max-w-7xl mx-auto px-6 py-4">
      <nav class="flex items-center justify-between">
        <div class="flex items-center space-x-3">
          <!-- Logo -->
          <svg class="w-10 h-10 text-blue-400" viewBox="0 0 100 100" fill="currentColor" aria-hidden="true">
            <circle cx="50" cy="50" r="45" fill="none" stroke="currentColor" stroke-width="2"/>
            <path d="M30 50 L50 30 L70 50 L50 70 Z" fill="currentColor" opacity="0.7"/>
            <circle cx="50" cy="50" r="8" fill="currentColor"/>
            <path d="M50 20 L50 80 M20 50 L80 50" stroke="currentColor" stroke-width="1" opacity=".5"/>
          </svg>
          <h1 class="text-2xl font-bold bg-gradient-to-r from-blue-400 to-purple-400 bg-clip-text text-transparent editing-enabled" data-key="brand-title">Ali di Scienza</h1>
        </div>

        <!-- Menu Desktop -->
        <div class="desktop-menu flex space-x-6">
          <a href="#home" class="nav-link text-gray-300 hover:text-blue-400" data-page="home">Progetto</a>
          <a href="#materials" class="nav-link text-gray-300 hover:text-blue-400" data-page="materials">Materiali</a>
          <a href="#application" class="nav-link text-gray-300 hover:text-blue-400" data-page="application">Candidature</a>
          <a href="#program" class="nav-link text-gray-300 hover:text-blue-400" data-page="program">Programma</a>
          <a href="#media" class="nav-link text-gray-300 hover:text-blue-400" data-page="media">Media</a>
          <a href="#communications" class="nav-link text-gray-300 hover:text-blue-400" data-page="communications">Comunicazioni</a>
          <a href="#webmaster" class="nav-link text-gray-300 hover:text-blue-400" data-page="webmaster">Webmaster</a>
        </div>

        <!-- Menu Mobile -->
        <button class="mobile-menu-btn text-gray-300 hover:text-blue-400" id="mobileMenuBtn" aria-label="Apri menu">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></svg>
        </button>
      </nav>

      <div class="mobile-menu mt-4 pb-4" id="mobileMenu" aria-hidden="true">
        <div class="flex flex-col space-y-3">
          <a href="#home" class="nav-link text-gray-300 hover:text-blue-400 py-2" data-page="home">Progetto</a>
          <a href="#materials" class="nav-link text-gray-300 hover:text-blue-400 py-2" data-page="materials">Materiali</a>
          <a href="#application" class="nav-link text-gray-300 hover:text-blue-400 py-2" data-page="application">Candidature</a>
          <a href="#program" class="nav-link text-gray-300 hover:text-blue-400 py-2" data-page="program">Programma</a>
          <a href="#media" class="nav-link text-gray-300 hover:text-blue-400 py-2" data-page="media">Media</a>
          <a href="#communications" class="nav-link text-gray-300 hover:text-blue-400 py-2" data-page="communications">Comunicazioni</a>
          <a href="#webmaster" class="nav-link text-gray-300 hover:text-blue-400 py-2" data-page="webmaster">Webmaster</a>
        </div>
      </div>
    </div>
  </header>

  <!-- Toolbar azioni (visibile solo su Webmaster) -->
  <div id="toolbarActions" class="sticky top-16 z-30 bg-black/30 backdrop-blur-md border-y border-blue-500/20">
    <div class="max-w-7xl mx-auto px-6 py-3 flex flex-wrap gap-2 items-center">
      <button id="toggleEdit" class="px-4 py-2 rounded bg-blue-600 hover:bg-blue-700">‚úèÔ∏è Modalit√† editing</button>
      <button id="saveEdits" class="px-4 py-2 rounded bg-emerald-600 hover:bg-emerald-700">üíæ Salva (local)</button>
      <button id="clearEdits" class="px-4 py-2 rounded bg-red-600 hover:bg-red-700">üßπ Ripristina</button>
      <span class="text-xs text-gray-300">(Il salvataggio resta nel tuo browser)</span>
    </div>
  </div>

  <main class="min-h-full">
    <!-- HOME / Progetto -->
    <section id="home" class="page active">
      <section class="py-20 px-6 relative overflow-hidden">
        <div class="absolute inset-0 opacity-20">
          <div class="absolute top-10 left-10 w-2 h-2 bg-blue-400 rounded-full pulse-animation"></div>
          <div class="absolute top-32 right-20 w-1 h-1 bg-purple-400 rounded-full pulse-animation" style="animation-delay:.5s"></div>
          <div class="absolute bottom-20 left-1/4 w-3 h-3 bg-cyan-400 rounded-full pulse-animation" style="animation-delay:1s"></div>
          <div class="absolute top-1/2 right-10 w-2 h-2 bg-pink-400 rounded-full pulse-animation" style="animation-delay:1.5s"></div>
        </div>
        <div class="max-w-6xl mx-auto text-center relative z-10">
          <div class="floating-animation mb-8">
            <svg class="w-32 h-32 mx-auto text-blue-400" viewBox="0 0 200 200" fill="currentColor" aria-hidden="true">
              <defs>
                <linearGradient id="shipGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                  <stop offset="0%" style="stop-color:#60a5fa"/>
                  <stop offset="100%" style="stop-color:#a78bfa"/>
                </linearGradient>
              </defs>
              <path d="M100 20 L140 60 L120 100 L100 80 L80 100 L60 60 Z" fill="url(#shipGradient)"/>
              <circle cx="100" cy="60" r="15" fill="#ffffff" opacity="0.8"/>
            </svg>
          </div>
          <h1 class="text-6xl font-bold mb-6 bg-gradient-to-r from-blue-400 via-purple-400 to-cyan-400 bg-clip-text text-transparent editing-enabled" data-key="home-title">Ali di Scienza</h1>
          <p class="text-2xl text-gray-300 mb-8 max-w-4xl mx-auto editing-enabled" data-key="home-subtitle">Percorso PCTO nel mondo dell'aviazione: dalla fisica del volo alla meteorologia, dalla tecnica di pilotaggio alla manutenzione.</p>
          <div class="flex flex-wrap justify-center gap-4">
            <a href="#materials" class="bg-gradient-to-r from-blue-500 to-purple-600 text-white px-8 py-4 rounded-full text-lg font-semibold hover-lift neon-glow">üöÄ Inizia l'Avventura</a>
            <a href="#program" class="border-2 border-blue-400 text-blue-400 px-8 py-4 rounded-full text-lg font-semibold hover:bg-blue-400 hover:text-white transition-all">üìñ Scopri di pi√π</a>
          </div>
        </div>
      </section>

      <section class="py-16 px-6">
        <div class="max-w-6xl mx-auto">
          <h2 class="text-4xl font-bold text-center mb-12 bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text text-transparent editing-enabled" data-key="caratteristiche-title">Caratteristiche del Progetto</h2>
          <div class="grid md:grid-cols-3 gap-8">
            <div class="bg-gradient-to-br from-blue-900 to-purple-900 p-8 rounded-2xl hover-lift border border-blue-500/30">
              <div class="flex items-center gap-3 mb-4">
                <svg class="w-8 h-8 text-cyan-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="12" cy="12" r="1.6"/></svg>
                <h3 class="text-2xl font-bold text-white">Fisica del Volo</h3>
              </div>
              <p class="text-gray-300">Comprendi come e perch√© vola l'aliante: volo planato, resistenza dell'aria, cenni di pilotaggio.</p>
            </div>
            <div class="bg-gradient-to-br from-purple-900 to-pink-900 p-8 rounded-2xl hover-lift border border-purple-500/30">
              <div class="flex items-center gap-3 mb-4">
                <svg class="w-8 h-8 text-amber-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><circle cx="7" cy="7" r="3"/></svg>
                <h3 class="text-2xl font-bold text-white">Meteorologia</h3>
              </div>
              <p class="text-gray-300">Pressione, vento, stabilit√†, nubi e fenomeni convettivi per un volo consapevole.</p>
            </div>
            <div class="bg-gradient-to-br from-cyan-900 to-blue-900 p-8 rounded-2xl hover-lift border border-cyan-500/30">
              <div class="flex items-center gap-3 mb-4">
                <svg class="w-8 h-8 text-blue-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8"><circle cx="12" cy="12" r="10"/></svg>
                <h3 class="text-2xl font-bold text-white">Tecnica di Pilotaggio</h3>
              </div>
              <p class="text-gray-300">Strumenti, tecniche, gestione emergenze e pianificazione del volo.</p>
            </div>
          </div>
        </div>
      </section>
    </section>

    <!-- MATERIALI -->
    <section id="materials" class="page">
      <section class="py-20 px-6">
        <div class="max-w-6xl mx-auto">
          <div class="text-center mb-16">
            <h1 class="text-5xl font-bold mb-6 bg-gradient-to-r from-green-400 to-blue-400 bg-clip-text text-transparent editing-enabled" data-key="materials-title">üìö Materiali Didattici</h1>
            <p class="text-xl text-gray-300 max-w-3xl mx-auto editing-enabled" data-key="materials-subtitle">Accedi a manuali, fogli di calcolo e risorse multimediali per il tuo percorso PCTO.</p>
          </div>

          <div id="materialsGrid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
            <div class="bg-gradient-to-br from-blue-900 to-indigo-900 p-8 rounded-2xl hover-lift border border-blue-500/30" data-material="m1">
              <h3 class="text-2xl font-bold text-white mb-2 editing-enabled" data-key="m1-title">Manuale di Aerodinamica</h3>
              <p class="text-gray-300 mb-4 editing-enabled" data-key="m1-desc">Guida ai principi fisici del volo.</p>
              <a id="m1-download" class="material-download w-full inline-block bg-blue-600 hover:bg-blue-700 text-white py-3 px-4 rounded-lg font-semibold text-center" href="files/manuale-aerodinamica.pdf" target="_blank" rel="noopener">üì• Scarica Manuale</a>
              <div class="editing-controls mt-4" data-controls-for="m1">
                <label class="material-hint">Link esterno (Drive/Dropbox) o URL file:</label>
                <div class="material-controls">
                  <input id="m1-url" class="material-link-input" type="url" placeholder="https://drive.google.com/..." />
                  <button class="btn bg-indigo-600 hover:bg-indigo-700 text-white" data-action="save-link" data-material="m1">Salva</button>
                  <button class="btn bg-gray-700 hover:bg-gray-600 text-white" data-action="clear-link" data-material="m1">Rimuovi</button>
                </div>
                <div class="material-hint">Incolla il link condiviso da Drive; lo convertir√≤ in download diretto quando possibile.</div>
              </div>
            </div>

            <div class="bg-gradient-to-br from-green-900 to-emerald-900 p-8 rounded-2xl hover-lift border border-green-500/30" data-material="m2">
              <h3 class="text-2xl font-bold text-white mb-2 editing-enabled" data-key="m2-title">Calcoli di Volo</h3>
              <p class="text-gray-300 mb-4 editing-enabled" data-key="m2-desc">Fogli Excel con formule e simulazioni.</p>
              <a id="m2-download" class="material-download w-full inline-block bg-green-600 hover:bg-green-700 text-white py-3 px-4 rounded-lg font-semibold text-center" href="files/calcoli-volo.xlsx" target="_blank" rel="noopener">üì• Scarica Calcoli</a>
              <div class="editing-controls mt-4" data-controls-for="m2">
                <label class="material-hint">Link esterno (Drive/Dropbox) o URL file:</label>
                <div class="material-controls">
                  <input id="m2-url" class="material-link-input" type="url" placeholder="https://drive.google.com/..." />
                  <button class="btn bg-indigo-600 hover:bg-indigo-700 text-white" data-action="save-link" data-material="m2">Salva</button>
                  <button class="btn bg-gray-700 hover:bg-gray-600 text-white" data-action="clear-link" data-material="m2">Rimuovi</button>
                </div>
                <div class="material-hint">Incolla il link condiviso da Drive; lo convertir√≤ in download diretto quando possibile.</div>
              </div>
            </div>

            <div class="bg-gradient-to-br from-purple-900 to-pink-900 p-8 rounded-2xl hover-lift border border-purple-500/30" data-material="m3">
              <h3 class="text-2xl font-bold text-white mb-2 editing-enabled" data-key="m3-title">Video Lezioni</h3>
              <p class="text-gray-300 mb-4 editing-enabled" data-key="m3-desc">Tutorial pratici e dimostrazioni.</p>
              <a id="m3-download" class="material-download w-full inline-block bg-purple-600 hover:bg-purple-700 text-white py-3 px-4 rounded-lg font-semibold text-center" href="files/video-lezioni.zip" target="_blank" rel="noopener">üì• Scarica Video</a>
              <div class="editing-controls mt-4" data-controls-for="m3">
                <label class="material-hint">Link esterno (Drive/Dropbox) o URL file:</label>
                <div class="material-controls">
                  <input id="m3-url" class="material-link-input" type="url" placeholder="https://drive.google.com/..." />
                  <button class="btn bg-indigo-600 hover:bg-indigo-700 text-white" data-action="save-link" data-material="m3">Salva</button>
                  <button class="btn bg-gray-700 hover:bg-gray-600 text-white" data-action="clear-link" data-material="m3">Rimuovi</button>
                </div>
                <div class="material-hint">Incolla il link condiviso da Drive; lo convertir√≤ in download diretto quando possibile.</div>
              </div>
            </div>
          </div>

          <div class="mt-16 bg-gradient-to-r from-gray-800 to-gray-900 p-8 rounded-2xl">
            <h2 class="text-3xl font-bold text-center mb-8 text-white editing-enabled" data-key="risorse-title">üìñ Risorse Aggiuntive</h2>
            <div class="grid md:grid-cols-2 gap-8">
              <div>
                <h3 class="text-xl font-bold text-blue-400 mb-4 editing-enabled" data-key="links-title">üåê Link Utili</h3>
                <ul class="space-y-2 text-gray-300">
                  <li class="editing-enabled" data-key="link1">‚Ä¢ Simulatori di volo online</li>
                  <li class="editing-enabled" data-key="link2">‚Ä¢ Database meteorologici</li>
                  <li class="editing-enabled" data-key="link3">‚Ä¢ Calcolatori prestazioni</li>
                  <li class="editing-enabled" data-key="link4">‚Ä¢ Mappe aeronautiche</li>
                </ul>
              </div>
              <div>
                <h3 class="text-xl font-bold text-green-400 mb-4 editing-enabled" data-key="biblio-title">üìö Bibliografia</h3>
                <ul class="space-y-2 text-gray-300">
                  <li class="editing-enabled" data-key="book1">‚Ä¢ "Principi del Volo" ‚Äì Anderson</li>
                  <li class="editing-enabled" data-key="book2">‚Ä¢ "Meteorologia Aeronautica" ‚Äì Rossi</li>
                  <li class="editing-enabled" data-key="book3">‚Ä¢ "Tecniche di Pilotaggio" ‚Äì Bianchi</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </section>
    </section>

    <!-- APPLICATION (CANDIDATURE) - the form is kept as you requested -->
    <section id="application" class="page">
      <section class="py-20 px-6">
        <div class="max-w-4xl mx-auto">
          <div class="text-center mb-12">
            <h1 class="text-5xl font-bold mb-4 bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent editing-enabled" data-key="app-title">üéØ Candidature PCTO</h1>
            <p class="text-xl text-gray-300 max-w-3xl mx-auto editing-enabled" data-key="app-subtitle">Compila il modulo per candidare la tua scuola al progetto "Ali di Scienza".</p>
          </div>

          <div class="bg-gradient-to-br from-gray-800 to-gray-900 p-8 rounded-2xl border border-purple-500/30">
            <form id="applicationForm" class="space-y-6">
              <div class="grid md:grid-cols-2 gap-6">
                <div>
                  <label for="schoolName" class="block text-sm font-medium text-gray-300 mb-2">üè´ Nome Istituto *</label>
                  <input type="text" id="schoolName" name="schoolName" required class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent" />
                </div>
                <div>
                  <label for="schoolType" class="block text-sm font-medium text-gray-300 mb-2">üìö Tipo di Scuola *</label>
                  <select id="schoolType" name="schoolType" required class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                    <option value="">Seleziona tipo</option>
                    <option value="liceo-scientifico">Liceo Scientifico</option>
                    <option value="istituto-tecnico">Istituto Tecnico</option>
                    <option value="istituto-professionale">Istituto Professionale</option>
                    <option value="altro">Altro</option>
                  </select>
                </div>
              </div>

              <div class="grid md:grid-cols-2 gap-6">
                <div>
                  <label for="city" class="block text-sm font-medium text-gray-300 mb-2">üåç Citt√† *</label>
                  <input type="text" id="city" name="city" required class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent" />
                </div>
                <div>
                  <label for="province" class="block text-sm font-medium text-gray-300 mb-2">üìç Provincia *</label>
                  <input type="text" id="province" name="province" required class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent" />
                </div>
              </div>

              <div class="border-t border-gray-600 pt-6">
                <h3 class="text-xl font-bold text-white mb-4 editing-enabled" data-key="ref-title">üë®üè´ Referente del Progetto</h3>
                <div class="grid md:grid-cols-2 gap-6">
                  <div>
                    <label for="contactName" class="block text-sm font-medium text-gray-300 mb-2">üë§ Nome e Cognome *</label>
                    <input type="text" id="contactName" name="contactName" required class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent" />
                  </div>
                  <div>
                    <label for="contactRole" class="block text-sm font-medium text-gray-300 mb-2">üíº Ruolo *</label>
                    <input type="text" id="contactRole" name="contactRole" required class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent" />
                  </div>
                </div>
                <div class="grid md:grid-cols-2 gap-6 mt-6">
                  <div>
                    <label for="contactEmail" class="block text-sm font-medium text-gray-300 mb-2">üìß Email *</label>
                    <input type="email" id="contactEmail" name="contactEmail" required class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent" />
                  </div>
                  <div>
                    <label for="contactPhone" class="block text-sm font-medium text-gray-300 mb-2">üì± Telefono</label>
                    <input type="tel" id="contactPhone" name="contactPhone" class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent" />
                  </div>
                </div>
              </div>

              <div class="border-t border-gray-600 pt-6">
                <h3 class="text-xl font-bold text-white mb-4 editing-enabled" data-key="details-title">üìä Dettagli del Progetto</h3>
                <div class="grid md:grid-cols-2 gap-6">
                  <div>
                    <label for="studentsNumber" class="block text-sm font-medium text-gray-300 mb-2">üë• Numero Studenti *</label>
                    <select id="studentsNumber" name="studentsNumber" required class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                      <option value="">Seleziona numero</option>
                      <option value="10-20">10‚Äì20</option>
                      <option value="21-30">21‚Äì30</option>
                      <option value="31-50">31‚Äì50</option>
                      <option value="50+">Pi√π di 50</option>
                    </select>
                  </div>
                  <div>
                    <label for="classYear" class="block text-sm font-medium text-gray-300 mb-2">üéì Anno Scolastico *</label>
                    <select id="classYear" name="classYear" required class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                      <option value="">Seleziona anno</option>
                      <option value="terzo">Terzo</option>
                      <option value="quarto">Quarto</option>
                      <option value="quinto">Quinto</option>
                      <option value="misto">Classi Miste</option>
                    </select>
                  </div>
                </div>
                <div class="mt-6">
                  <label for="projectPeriod" class="block text-sm font-medium text-gray-300 mb-2">üìÖ Periodo Preferito *</label>
                  <select id="projectPeriod" name="projectPeriod" required class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent">
                    <option value="">Seleziona periodo</option>
                    <option value="ottobre-dicembre">Ottobre ‚Äì Dicembre</option>
                    <option value="gennaio-marzo">Gennaio ‚Äì Marzo</option>
                    <option value="aprile-giugno">Aprile ‚Äì Giugno</option>
                    <option value="flessibile">Flessibile</option>
                  </select>
                </div>
              </div>

              <div class="border-t border-gray-600 pt-6">
                <label for="motivation" class="block text-sm font-medium text-gray-300 mb-2">üí≠ Motivazioni e Aspettative *</label>
                <textarea id="motivation" name="motivation" rows="4" required placeholder="Perch√© siete interessati al progetto e cosa vi aspettate..." class="w-full px-4 py-3 bg-gray-700 border border-gray-600 rounded-lg text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none"></textarea>
              </div>

              <div class="border-t border-gray-600 pt-6">
                <label class="flex items-start space-x-3 text-gray-300">
                  <input type="checkbox" id="privacy" name="privacy" required class="w-5 h-5 text-purple-600 bg-gray-700 border-gray-600 rounded focus:ring-purple-500 mt-1" />
                  <span class="text-sm">Accetto il trattamento dei dati personali (GDPR) per le finalit√† del progetto PCTO *</span>
                </label>
              </div>

              <div class="text-center pt-6">
                <button type="submit" class="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-12 py-4 rounded-full text-lg font-semibold hover-lift neon-glow">üöÄ Invia Candidatura</button>
              </div>
            </form>
          </div>

          <div class="mt-12 grid md:grid-cols-2 gap-8">
            <div class="bg-gradient-to-br from-blue-900 to-indigo-900 p-6 rounded-xl">
              <h3 class="text-xl font-bold text-white mb-4 editing-enabled" data-key="proc-title">üìã Processo di Selezione</h3>
              <ul class="space-y-2 text-gray-300 text-sm">
                <li class="editing-enabled" data-key="proc-1">‚Ä¢ Valutazione candidature entro 15 giorni</li>
                <li class="editing-enabled" data-key="proc-2">‚Ä¢ Colloquio conoscitivo con il referente</li>
                <li class="editing-enabled" data-key="proc-3">‚Ä¢ Definizione calendario e modalit√†</li>
                <li class="editing-enabled" data-key="proc-4">‚Ä¢ Avvio del progetto</li>
              </ul>
            </div>
            <div class="bg-gradient-to-br from-green-900 to-teal-900 p-6 rounded-xl">
              <h3 class="text-xl font-bold text-white mb-4 editing-enabled" data-key="contatti-title">üìû Contatti</h3>
              <div class="space-y-2 text-gray-300 text-sm">
                <p class="editing-enabled" data-key="contact-email">üìß Email: pcto@aeroclubao.it</p>
                <p class="editing-enabled" data-key="contact-phone">üì± Telefono: +39 0165 123456</p>
                <p class="editing-enabled" data-key="contact-site">üåê Sito: www.aeroclubao.it</p>
              </div>
            </div>
          </div>
        </div>
      </section>
    </section>

    <!-- PROGRAMMA -->
    <section id="program" class="page">
      <section class="py-20 px-6">
        <div class="max-w-6xl mx-auto">
          <div class="text-center mb-12">
            <h1 class="text-5xl font-bold mb-4 bg-gradient-to-r from-orange-400 to-red-400 bg-clip-text text-transparent editing-enabled" data-key="prog-title">üìÖ Programma del Corso (40 ore)</h1>
            <p class="text-xl text-gray-300 max-w-3xl mx-auto editing-enabled" data-key="prog-subtitle">Il percorso √® suddiviso in moduli teorici e attivit√† pratiche, con verifica finale.</p>
          </div>

          <div class="grid md:grid-cols-2 gap-8">
            <div class="bg-gradient-to-br from-blue-900 to-indigo-900 p-6 rounded-2xl border border-blue-500/30">
              <h3 class="text-2xl font-bold text-white mb-2 editing-enabled" data-key="mod1-title">Modulo 1: Introduzione all'Aviazione (4 ore)</h3>
              <p class="text-gray-300 editing-enabled" data-key="mod1-body">Storia dell'aviazione, classificazione degli aeromobili, normativa di base, sicurezza.</p>
              <ul class="text-sm text-gray-300 mt-3 space-y-1">
                <li>‚Ä¢ Lezioni frontali e discussione</li>
                <li>‚Ä¢ Materiale: manuale introduttivo</li>
              </ul>
            </div>

            <div class="bg-gradient-to-br from-purple-900 to-pink-900 p-6 rounded-2xl border border-purple-500/30">
              <h3 class="text-2xl font-bold text-white mb-2 editing-enabled" data-key="mod2-title">Modulo 2: Fisica del Volo (12 ore)</h3>
              <p class="text-gray-300 editing-enabled" data-key="mod2-body">Forze in volo, portanza, resistenza, profili alari; esercitazioni e misure.</p>
              <ul class="text-sm text-gray-300 mt-3 space-y-1">
                <li>‚Ä¢ Esperimenti pratici in laboratorio</li>
                <li>‚Ä¢ Calcoli di prestazioni</li>
              </ul>
            </div>

            <div class="bg-gradient-to-br from-green-900 to-teal-900 p-6 rounded-2xl border border-green-500/30">
              <h3 class="text-2xl font-bold text-white mb-2 editing-enabled" data-key="mod3-title">Modulo 3: Meteorologia Aeronautica (8 ore)</h3>
              <p class="text-gray-300 editing-enabled" data-key="mod3-body">Elementi di meteorologia, lettura carte meteo, previsioni e strumenti meteo.</p>
              <ul class="text-sm text-gray-300 mt-3 space-y-1">
                <li>‚Ä¢ Esercitazioni pratiche con dati reali</li>
                <li>‚Ä¢ Interpretazione di carte sinottiche</li>
              </ul>
            </div>

            <div class="bg-gradient-to-br from-amber-800 to-orange-700 p-6 rounded-2xl border border-amber-500/30">
              <h3 class="text-2xl font-bold text-white mb-2 editing-enabled" data-key="mod4-title">Modulo 4: Tecnica di Pilotaggio e Simulazioni (12 ore)</h3>
              <p class="text-gray-300 editing-enabled" data-key="mod4-body">Tecniche di pilotaggio, gestione emergenze, uso di simulatori e strumentazione.</p>
              <ul class="text-sm text-gray-300 mt-3 space-y-1">
                <li>‚Ä¢ Sessioni su simulatore</li>
                <li>‚Ä¢ Valutazione pratica finale</li>
              </ul>
            </div>
          </div>

          <div class="mt-10 text-center">
            <a href="files/prog-syllabus.pdf" class="inline-block bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-lg font-semibold" target="_blank">üì• Scarica il Programma completo (PDF)</a>
          </div>
        </div>
      </section>
    </section>

    <!-- MEDIA -->
    <section id="media" class="page">
      <section class="py-20 px-6">
        <div class="max-w-7xl mx-auto">
          <div class="text-center mb-12">
            <h1 class="text-5xl font-bold mb-4 bg-gradient-to-r from-pink-400 to-purple-400 bg-clip-text text-transparent editing-enabled" data-key="media-title">üé¨ Galleria Media</h1>
            <p class="text-xl text-gray-300 max-w-3xl mx-auto editing-enabled" data-key="media-subtitle">Foto, video e risorse multimediali raccolte durante le attivit√†.</p>
          </div>

          <div class="grid md:grid-cols-3 gap-6 mb-8" id="mediaGrid">
            <figure class="bg-gray-800/60 border border-gray-700 rounded-lg overflow-hidden"><img src="media/aliante1.jpg" alt="Aliante in decollo" class="w-full h-44 object-cover cursor-zoom-in" data-full="media/aliante1.jpg"><figcaption class="p-3 text-sm text-gray-300 editing-enabled" data-key="caption1">Aliante ‚Äì decollo al traino</figcaption></figure>
            <figure class="bg-gray-800/60 border border-gray-700 rounded-lg overflow-hidden"><img src="media/aliante2.jpg" alt="Termica" class="w-full h-44 object-cover cursor-zoom-in" data-full="media/aliante2.jpg"><figcaption class="p-3 text-sm text-gray-300 editing-enabled" data-key="caption2">Ricerca della termica</figcaption></figure>
            <figure class="bg-gray-800/60 border border-gray-700 rounded-lg overflow-hidden"><img src="media/aliante3.jpg" alt="Strumentazione" class="w-full h-44 object-cover cursor-zoom-in" data-full="media/aliante3.jpg"><figcaption class="p-3 text-sm text-gray-300 editing-enabled" data-key="caption3">Strumentazione di bordo</figcaption></figure>
          </div>

          <div class="mb-8">
            <h2 class="text-2xl font-bold text-white mb-4">Video selezionati</h2>
            <div class="grid md:grid-cols-2 gap-4">
              <div class="bg-gray-800/60 p-4 rounded-lg"><div class="aspect-w-16 aspect-h-9"><iframe src="https://www.youtube.com/embed/dQw4w9WgXcQ" frameborder="0" allowfullscreen class="w-full h-48 rounded"></iframe></div><p class="text-sm text-gray-300 mt-2 editing-enabled" data-key="video1-caption">Esempio: introduzione alla fisica del volo</p></div>
              <div class="bg-gray-800/60 p-4 rounded-lg"><div class="aspect-w-16 aspect-h-9"><iframe src="https://www.youtube.com/embed/ysz5S6PUM-U" frameborder="0" allowfullscreen class="w-full h-48 rounded"></iframe></div><p class="text-sm text-gray-300 mt-2 editing-enabled" data-key="video2-caption">Esempio: uso del simulatore</p></div>
            </div>
          </div>

          <div class="mt-6 text-sm text-gray-400">
            <p>Nota per il webmaster: puoi aggiornare i media inserendo link diretti (Drive/Dropbox) nella sezione Webmaster; i contenuti aggiunti saranno visualizzati a tutti quando li salvi centralmente.</p>
          </div>

          <!-- Lightbox -->
          <div id="lightbox" class="fixed inset-0 bg-black/80 hidden items-center justify-center z-50 p-4"><img id="lightboxImg" src="" alt="" class="max-h-full max-w-full rounded-lg shadow-2xl"/></div>
        </div>
      </section>
    </section>

    <!-- COMUNICAZIONI -->
    <section id="communications" class="page">
      <section class="py-20 px-6">
        <div class="max-w-6xl mx-auto">
          <div class="text-center mb-10">
            <h1 class="text-5xl font-bold mb-4 bg-gradient-to-r from-cyan-400 to-blue-400 bg-clip-text text-transparent editing-enabled" data-key="comm-title">üì£ Comunicazioni e Avvisi</h1>
            <p class="text-xl text-gray-300 max-w-3xl mx-auto editing-enabled" data-key="comm-subtitle">Avvisi, scadenze e documentazione ufficiale per le scuole partecipanti.</p>
          </div>

          <div class="grid md:grid-cols-2 gap-8 mb-10">
            <div class="bg-gray-800/60 p-6 rounded-lg border border-gray-700">
              <h3 class="text-xl font-bold text-white mb-3 editing-enabled" data-key="comm-latest-title">Ultimi avvisi</h3>
              <ul id="comm-list" class="space-y-3 text-gray-300">
                <li class="editing-enabled" data-key="comm-1">‚Ä¢ 2025-09-15 ‚Äî Pubblicazione bando PCTO (scadenza candidature: 2025-10-15)</li>
                <li class="editing-enabled" data-key="comm-2">‚Ä¢ 2025-10-01 ‚Äî Calendario incontri pubblicato (prima sessione: 2025-10-20)</li>
                <li class="editing-enabled" data-key="comm-3">‚Ä¢ 2025-10-05 ‚Äî Distribuzione materiali preparatori</li>
              </ul>
            </div>

            <div class="bg-gray-800/60 p-6 rounded-lg border border-gray-700">
              <h3 class="text-xl font-bold text-white mb-3 editing-enabled" data-key="comm-docs-title">Documenti utili</h3>
              <ul class="text-gray-300 space-y-2">
                <li><a href="files/bando-pcto.pdf" class="text-blue-300 underline" target="_blank">üìÑ Bando PCTO (PDF)</a></li>
                <li><a href="files/calendario-incontri.pdf" class="text-blue-300 underline" target="_blank">üìÖ Calendario Incontri (PDF)</a></li>
                <li><a href="files/checklist-docs.docx" class="text-blue-300 underline" target="_blank">üìã Checklist documenti (DOCX)</a></li>
              </ul>
            </div>
          </div>

          <div class="bg-gradient-to-br from-gray-900 to-gray-800 p-6 rounded-lg text-gray-300">
            <h4 class="font-bold mb-3 editing-enabled" data-key="comm-subscribe-title">Iscriviti per aggiornamenti</h4>
            <p class="mb-3 text-sm">Inserisci la tua email per ricevere notifiche via email (nota: in questa demo la mail viene memorizzata localmente nel browser).</p>
            <div class="flex gap-3 max-w-md">
              <input id="commEmail" type="email" placeholder="tuo@email.scuola.it" class="flex-1 px-3 py-2 rounded bg-gray-700 text-white" />
              <button id="commSubscribe" class="px-4 py-2 rounded bg-blue-600 hover:bg-blue-700">Iscriviti</button>
            </div>
            <div id="commFeedback" class="text-sm mt-3 text-green-400 hidden"></div>
          </div>
        </div>
      </section>
    </section>

    <!-- WEBMASTER -->
    <section id="webmaster" class="page">
      <section class="py-16 px-6">
        <div class="max-w-6xl mx-auto">
          <div class="text-center mb-8">
            <h1 class="text-4xl font-bold mb-2 bg-gradient-to-r from-yellow-400 to-red-400 bg-clip-text text-transparent">Webmaster</h1>
            <p class="text-gray-300">Area riservata al webmaster. Contatto: <strong>debora.lonardi@scuola.istruzione.it</strong></p>
            <p class="text-sm text-gray-400 mt-4">I controlli per editing (‚úèÔ∏è Modalit√† editing / üíæ Salva / üßπ Ripristina) sono disponibili solo in questa pagina.</p>
          </div>

          <div class="bg-gray-800/60 p-6 rounded-lg">
            <h3 class="font-bold text-lg text-white mb-4">Gestione Media & Materiali</h3>
            <p class="text-sm text-gray-300 mb-3">Nel pannello qui sotto puoi incollare link Drive/Dropbox per i materiali; quando li salvi verranno resi disponibili nelle pagine corrispondenti.</p>
            <!-- Simple panel (kept minimal because storage is local) -->
            <div class="grid md:grid-cols-3 gap-4">
              <div>
                <input id="web_img_url" class="w-full px-3 py-2 rounded bg-gray-700 text-white" placeholder="Link immagine / media" />
                <input id="web_img_title" class="w-full mt-2 px-3 py-2 rounded bg-gray-700 text-white" placeholder="Titolo (opzionale)" />
                <button id="web_add_image" class="mt-2 w-full px-3 py-2 rounded bg-blue-600 hover:bg-blue-700">Aggiungi immagine (in pagina Media)</button>
              </div>
              <div>
                <input id="web_vid_url" class="w-full px-3 py-2 rounded bg-gray-700 text-white" placeholder="Link video (YouTube o file)" />
                <input id="web_vid_title" class="w-full mt-2 px-3 py-2 rounded bg-gray-700 text-white" placeholder="Titolo (opzionale)" />
                <button id="web_add_video" class="mt-2 w-full px-3 py-2 rounded bg-green-600 hover:bg-green-700">Aggiungi video</button>
              </div>
              <div>
                <input id="web_mat_url" class="w-full px-3 py-2 rounded bg-gray-700 text-white" placeholder="Link materiale (PDF)" />
                <input id="web_mat_title" class="w-full mt-2 px-3 py-2 rounded bg-gray-700 text-white" placeholder="Titolo (opzionale)" />
                <button id="web_add_material" class="mt-2 w-full px-3 py-2 rounded bg-indigo-600 hover:bg-indigo-700">Aggiungi materiale</button>
              </div>
            </div>
            <p class="text-xs text-gray-400 mt-3">Nota: in questa versione demo i nuovi media/materiali vengono aggiunti dinamicamente nella pagina corrente ma non vengono salvati centralmente (serve backend per persistenza server-side).</p>
          </div>
        </div>
      </section>
    </section>

  </main>

  <script>
    // ===== Navigation / SPA =====
    function setActivePage(id) {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      const page = document.getElementById(id) || document.getElementById('home');
      page.classList.add('active');
      document.querySelectorAll('.nav-link').forEach(a => {
        a.classList.toggle('active', a.getAttribute('data-page') === id);
      });
      if (location.hash !== '#' + id) history.replaceState(null, '', '#' + id);
      const toolbar = document.getElementById('toolbarActions');
      if (toolbar) toolbar.classList.toggle('hidden', id !== 'webmaster');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    function initNav() {
      document.querySelectorAll('.nav-link').forEach(a => {
        a.addEventListener('click', (e) => {
          e.preventDefault();
          const id = a.getAttribute('data-page');
          setActivePage(id);
          const mm = document.getElementById('mobileMenu');
          mm.classList.remove('open');
          mm.setAttribute('aria-hidden','true');
        });
      });
      const start = (location.hash || '#home').replace('#','');
      setActivePage(start);
    }
    function initMobileMenu(){
      const btn = document.getElementById('mobileMenuBtn');
      const menu = document.getElementById('mobileMenu');
      btn.addEventListener('click', ()=> {
        const open = menu.classList.toggle('open');
        menu.setAttribute('aria-hidden', String(!open));
      });
    }

    // ===== Editing in-place =====
    let editing = false;
    function applyEditable(enabled){
      const nodes = document.querySelectorAll('.editing-enabled');
      nodes.forEach(n => {
        const tag = n.tagName.toLowerCase();
        const forbidden = ['a','button','input','select','textarea','svg','iframe'];
        if (forbidden.includes(tag)) return;
        if (enabled) n.setAttribute('contenteditable','true'); else n.removeAttribute('contenteditable');
      });
      const b = document.getElementById('editBanner');
      if (b) b.classList.toggle('hidden', !enabled);
      document.querySelectorAll('.editing-controls').forEach(ctrl => ctrl.classList.toggle('visible', Boolean(enabled)));
    }
    function initEditingToolbar(){
      const toggle = document.getElementById('toggleEdit');
      const save = document.getElementById('saveEdits');
      const clear = document.getElementById('clearEdits');
      const EDIT_CODE = 'ACAO-Edit-2025';
      const EDIT_KEY  = 'pctosite_editor';
      function isUnlocked(){ return sessionStorage.getItem(EDIT_KEY) === '1'; }
      if (toggle) toggle.addEventListener('click', ()=> {
        if (!isUnlocked()){
          const code = prompt('Inserisci il codice per attivare la Modalit√† Editing:');
          if (code === null) return;
          if (code !== EDIT_CODE) { alert('Codice errato'); return; }
          sessionStorage.setItem(EDIT_KEY, '1');
        }
        editing = !editing;
        applyEditable(editing);
      });
      if (save) save.addEventListener('click', ()=>{
        const data = {};
        document.querySelectorAll('.editing-enabled[data-key]').forEach(el=>{
          data[el.getAttribute('data-key')] = el.innerHTML.trim();
        });
        localStorage.setItem('pctosite_edits', JSON.stringify(data));
        alert('Contenuti salvati nel browser.');
      });
      if (clear) clear.addEventListener('click', ()=>{
        if (confirm('Ripristinare i testi originali?')){
          localStorage.removeItem('pctosite_edits');
          location.reload();
        }
      });
      const saved = localStorage.getItem('pctosite_edits');
      if (saved){
        try {
          const data = JSON.parse(saved);
          Object.entries(data).forEach(([k,v])=>{
            const el = document.querySelector(`[data-key="${k}"]`);
            if (el) el.innerHTML = v;
          });
        } catch(e){ console.warn('Salvataggio non valido'); }
      }
    }

    // ===== Material links (localStorage) =====
    const MATERIALS_KEY = 'pctosite_material_links';
    function driveShareToDirect(url){
      if (!url) return url;
      const re1 = /\/d\/([a-zA-Z0-9_-]+)/;
      const re2 = /id=([a-zA-Z0-9_-]+)/;
      let m = url.match(re1);
      if (!m) m = url.match(re2);
      if (m && m[1]) return 'https://drive.google.com/uc?export=download&id=' + m[1];
      if (url.includes('dropbox.com')) return url.replace('?dl=0','?dl=1');
      return url;
    }
    function loadMaterialLinks(){ try { const raw = localStorage.getItem(MATERIALS_KEY); return raw ? JSON.parse(raw) : {}; } catch(e){ return {}; } }
    function saveMaterialLinks(obj){ localStorage.setItem(MATERIALS_KEY, JSON.stringify(obj)); }
    function setMaterialLink(key, url){
      const obj = loadMaterialLinks();
      if (!url) delete obj[key]; else obj[key] = url;
      saveMaterialLinks(obj);
      applyMaterialLinkToDOM(key, url);
    }
    function applyMaterialLinkToDOM(key, url){
      const anchor = document.getElementById(key + '-download') || document.querySelector(`[data-material="${key}"] .material-download`);
      if (!anchor) return;
      if (url) { anchor.href = url; anchor.setAttribute('target','_blank'); anchor.setAttribute('rel','noopener'); }
      else {
        const defaults = {'m1': 'files/manuale-aerodinamica.pdf','m2':'files/calcoli-volo.xlsx','m3':'files/video-lezioni.zip'};
        if (defaults[key]) { anchor.href = defaults[key]; anchor.removeAttribute('target'); anchor.removeAttribute('rel'); } else anchor.removeAttribute('href');
      }
    }
    function applyAllMaterialLinks(){
      const obj = loadMaterialLinks();
      ['m1','m2','m3'].forEach(k => { const url = obj[k]; if (url) applyMaterialLinkToDOM(k, url); });
      Object.entries(obj).forEach(([k,v])=>{ const input = document.getElementById(k + '-url'); if (input) input.value = v; });
    }
    function initMaterialControls(){
      document.querySelectorAll('[data-action="save-link"]').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const key = btn.getAttribute('data-material');
          const input = document.getElementById(key + '-url');
          if (!input) return;
          const raw = input.value.trim();
          if (!raw) return alert('Inserisci un URL valido');
          const direct = driveShareToDirect(raw);
          setMaterialLink(key, direct);
          alert('Link salvato per ' + key);
        });
      });
      document.querySelectorAll('[data-action="clear-link"]').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const key = btn.getAttribute('data-material');
          const input = document.getElementById(key + '-url');
          if (input) input.value = '';
          setMaterialLink(key, null);
          alert('Link rimosso per ' + key);
        });
      });
    }

    // ===== Communications subscribe (local demo) =====
    function initCommunications(){
      const btn = document.getElementById('commSubscribe');
      const emailInput = document.getElementById('commEmail');
      const feedback = document.getElementById('commFeedback');
      btn?.addEventListener('click', ()=>{
        const email = emailInput.value.trim();
        if (!email || !email.includes('@')) return alert('Inserisci una email valida');
        let list = [];
        try { list = JSON.parse(localStorage.getItem('pctosite_subscribers') || '[]'); } catch(e){ list = []; }
        if (!list.includes(email)) { list.push(email); localStorage.setItem('pctosite_subscribers', JSON.stringify(list)); }
        feedback.textContent = 'Grazie ‚Äî email salvata localmente (demo).';
        feedback.classList.remove('hidden');
        setTimeout(()=> feedback.classList.add('hidden'), 4000);
      });
    }

    // ===== Lightbox =====
    function initLightbox(){
      const lb = document.getElementById('lightbox');
      const lbImg = document.getElementById('lightboxImg');
      document.querySelectorAll('#mediaGrid img').forEach(img=>{
        img.addEventListener('click', ()=>{
          lbImg.src = img.getAttribute('data-full') || img.src;
          lb.classList.remove('hidden'); lb.classList.add('flex');
        });
      });
      if (lb) {
        lb.addEventListener('click', ()=>{ lb.classList.add('hidden'); lb.classList.remove('flex'); const lbImg = document.getElementById('lightboxImg'); if (lbImg) lbImg.src = ''; });
        document.addEventListener('keydown', (e)=>{ if (e.key==='Escape') lb.click(); });
      }
    }

    // ===== Simple webmaster adders (client only) =====
    function initWebmasterAdders(){
      document.getElementById('web_add_image')?.addEventListener('click', ()=>{
        const url = document.getElementById('web_img_url').value.trim();
        const title = document.getElementById('web_img_title').value.trim();
        if (!url) return alert('Inserisci un URL immagine');
        const grid = document.getElementById('mediaGrid');
        if (!grid) return alert('Galleria non trovata');
        const fig = document.createElement('figure');
        fig.className = 'bg-gray-800/60 border border-gray-700 rounded-lg overflow-hidden';
        fig.innerHTML = `<img src="${url}" alt="${title||''}" class="w-full h-44 object-cover cursor-zoom-in" data-full="${url}"><figcaption class="p-3 text-sm text-gray-300">${title||''}</figcaption>`;
        grid.prepend(fig);
        initLightbox(); // reattach
        alert('Immagine aggiunta (client-side)');
      });
      document.getElementById('web_add_video')?.addEventListener('click', ()=>{
        const url = document.getElementById('web_vid_url').value.trim();
        const title = document.getElementById('web_vid_title').value.trim();
        if (!url) return alert('Inserisci un URL video');
        const parent = document.querySelector('#media .max-w-7xl');
        if (!parent) return alert('Sezione media non trovata');
        const node = document.createElement('div');
        node.className = 'bg-gray-800/60 p-4 rounded-lg mb-4';
        if (/youtube\.com|youtu\.be/.test(url)) {
          const embed = url.replace('watch?v=','embed/').replace('youtu.be/','youtube.com/embed/');
          node.innerHTML = `<div class="aspect-w-16 aspect-h-9"><iframe src="${embed}" frameborder="0" allowfullscreen class="w-full h-48 rounded"></iframe></div><div class="p-2 text-sm text-gray-300">${title||''}</div>`;
        } else {
          node.innerHTML = `<div class="text-sm text-gray-200 mb-2">${title||'Video'}</div><a href="${url}" target="_blank" class="text-sm text-blue-300 underline break-all">${url}</a>`;
        }
        parent.prepend(node);
        alert('Video aggiunto (client-side)');
      });
      document.getElementById('web_add_material')?.addEventListener('click', ()=>{
        const url = document.getElementById('web_mat_url').value.trim();
        const title = document.getElementById('web_mat_title').value.trim();
        if (!url) return alert('Inserisci un URL materiale');
        const grid = document.getElementById('materialsGrid');
        if (!grid) return alert('Sezione materiali non trovata');
        const card = document.createElement('div');
        card.className = 'bg-gradient-to-br from-gray-800 to-gray-900 p-6 rounded-2xl hover-lift border border-gray-700/30';
        card.innerHTML = `<h3 class="text-2xl font-bold text-white mb-2">${title || 'Materiale'}</h3><a href="${url}" target="_blank" class="inline-block bg-indigo-600 hover:bg-indigo-700 text-white py-3 px-4 rounded-lg font-semibold text-center">üì• Apri / Scarica</a>`;
        grid.prepend(card);
        alert('Materiale aggiunto (client-side)');
      });
    }

    // ===== Init all =====
    document.addEventListener('DOMContentLoaded', ()=>{
      initNav();
      initMobileMenu();
      initEditingToolbar();
      applyEditable(false);
      initLightbox();
      initMaterialControls();
      applyAllMaterialLinks();
      initCommunications();
      initWebmasterAdders();

      // hide toolbar unless #webmaster
      const start = (location.hash || '#home').replace('#','');
      const toolbar = document.getElementById('toolbarActions');
      if (toolbar) toolbar.classList.toggle('hidden', start !== 'webmaster');
    });
  </script>
</body>
</html>
